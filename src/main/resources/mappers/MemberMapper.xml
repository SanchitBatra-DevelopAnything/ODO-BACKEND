<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.odo.b2b.backend.ODO_B2B.mapper.MemberMapper">


    <resultMap id="NotificationDTOMap" type="com.odo.b2b.backend.ODO_B2B.model.MemberNotification.MemberNotificationDTO">
        <result property="GST" column="GST" />
        <result property="area" column="areaName" />
        <result property="contact" column="contact" />
        <result property="name" column="name" />
        <result property="shop" column="shop" />
        <result property="shopAddress" column="shopAddress" />
        <result property="deviceToken" column="deviceToken" />
        <result property="latitude" column="latitude" />
        <result property="longitude" column="longitude" />
    </resultMap>

    <resultMap id="NotificationWithIdMap" type="com.odo.b2b.backend.ODO_B2B.model.MemberNotification.MemberNotificationWithID">
        <id property="id" column="notificationId"/>
        <association property="notification" resultMap="NotificationDTOMap"/>
    </resultMap>

    <insert id="insertNotification">
        INSERT INTO member_notification (
        notificationId,
        GST,
        areaId,
        contact,
        name,
        shop,
        shopAddress,
        deviceToken,
        latitude,
        longitude
        ) VALUES (
        #{id},
        #{GST},
        #{areaId},
        #{contact},
        #{name},
        #{shop},
        #{shopAddress},
        #{deviceToken},
        #{latitude},
        #{longitude}
        )
    </insert>



    <select id="getAllNotificationsWithArea" resultMap="NotificationWithIdMap">
        SELECT
        n.notificationId, n.GST, n.contact, n.name, n.shop, n.shopAddress,
        n.deviceToken, n.latitude, n.longitude, a.areaName
        FROM member_notification n
        LEFT JOIN area a ON n.areaId = a.areaId;
    </select>

    <delete id="deleteMemberNotification" parameterType="string">
        DELETE FROM member_notification WHERE notificationId = #{notificationId}
    </delete>

</mapper>
